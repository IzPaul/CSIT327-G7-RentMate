{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment - Tenant</title>
    <link rel="stylesheet" href="{% static 'css/tenant-maintenance.css' %}">
    <link rel="stylesheet" href="{% static 'css/home.css' %}">
    <link rel="stylesheet" href="{% static 'css/tenant-payment.css' %}">
</head>
<body>
    <!-- Left Sidebar Navigation -->
    <div class="sidebar left-sidebar">
        <div class="nav-section">
            <div class="nav-title">Navigation</div>
            <a href="{% url 'tenant_home' %}" class="nav-item {% if request.resolver_match.url_name == 'tenant_home' %}active{% endif %}">
                <svg fill="currentColor" viewBox="0 0 20 20">
                    <path d="M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z"/>
                </svg>
                Dashboard
            </a>
            <a href="{% url 'tenant_payment' %}" class="nav-item {% if request.resolver_match.url_name == 'tenant_payment' %}active{% endif %}">
                <svg fill="currentColor" viewBox="0 0 20 20" width="20" height="20">
                    <path d="M4 4a2 2 0 00-2 2v1h16V6a2 2 0 00-2-2H4z"/>
                    <path fill-rule="evenodd" d="M18 9H2v5a2 2 0 002 2h12a2 2 0 002-2V9zM4 13a1 1 0 011-1h1a1 1 0 110 2H5a1 1 0 01-1-1zm5-1a1 1 0 100 2h1a1 1 0 100-2H9z" clip-rule="evenodd"/>
                </svg>
                Payment
            </a>
        </div>

        <div class="nav-section">
            <div class="nav-title">Management</div>
            <a href="{% url 'tenant_maintenance' %}" class="nav-item {% if request.resolver_match.url_name == 'tenant_maintenance' %}active{% endif %}">
                <svg fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd"/>
                </svg>
                Maintenance
            </a>
            <a href="#" class="nav-item">
                <svg fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd"/>
                </svg>
                Calendar
            </a>
            <a href="#" class="nav-item">
                <svg fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd"/>
                </svg>
                Settings
            </a>
        </div>

        <div class="logout-section">
                <form method="post" action="{% url 'logout:logout' %}">
                    {% csrf_token %}
                        <button type="submit" class="logout-btn">Log out</button>
                </form>
        </div>

        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <div class="header">
            <div class="header-left">
                <div class="logo-circle"></div>
                <h1 class="logo-text">RentMate</h1>
            </div>
            <div class="header-right">
                <button class="icon-btn">
                    <svg fill="currentColor" viewBox="0 0 20 20" width="24" height="24">
                        <path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd"/>
                    </svg>
                </button>
                <button class="icon-btn">
                    <svg fill="currentColor" viewBox="0 0 20 20" width="24" height="24">
                        <path d="M10 2a6 6 0 00-6 6v3.586l-.707.707A1 1 0 004 14h12a1 1 0 00.707-1.707L16 11.586V8a6 6 0 00-6-6zM10 18a3 3 0 01-3-3h6a3 3 0 01-3 3z"/>
                    </svg>
                </button>
                <div class="user-avatar-header"></div>
            </div>
        </div>

        <div class="content-wrapper">
            <div class="history-section left-section">
                <div class="profile-card">
                    <div class="profile-avatar"></div>
                    <h3 class="profile-name">{{ tenant.first_name }} {{ tenant.last_name }}</h3>
                    <p class="profile-phone">{{ tenant.phone_number }}</p>
                </div>

                <div class="history-card">
                    <h4 class="history-title">History</h4>
                    <div class="history-list">
                        {% for request in maintenance_requests %}
                            <div class="history-item">
                                <div class="history-info">
                                    <p class="history-type">{{ request.maintenance_type }}</p>
                                    <p class="history-date">{{ request.date_requested|date:"F d, Y" }}</p>
                                </div>
                                <span class="status-badge {% if request.request_status == 'Completed' %}status-resolved{% elif request.request_status == 'Canceled' %}status-cancelled{% else %}status-pending{% endif %}">
                                    {% if request.request_status == 'Completed' %}
                                        Resolved
                                    {% elif request.request_status == 'Canceled' %}
                                        Cancelled
                                    {% else %}
                                        {{ request.request_status }}
                                    {% endif %}
                                </span>
                            </div>
                        {% empty %}
                            <p class="no-history">No maintenance history yet.</p>
                        {% endfor %}
                    </div>
                </div>
            </div>

            <div class="form-section">
                <h2 class="section-title">Maintenance Request</h2>
                <p class="section-subtitle">Complete this form to file a maintenance request for any issues related to facilities, equipment, or infrastructure. All submissions will be reviewed and scheduled based on urgency and availability.</p>

                {% if messages %}
                    {% for message in messages %}
                        {% if message.tags == 'error' %}
                            <div class="error-message">{{ message }}</div>
                        {% else %}
                            <div class="success-message">{{ message }}</div>
                        {% endif %}
                    {% endfor %}
                {% endif %}

                <form method="POST" class="maintenance-form">
                    {% csrf_token %}

                    <div class="form-group-modern">
                        <label class="form-label">Problem <span class="label-hint">(Select all that apply)</span></label>
                        <div class="checkbox-group">
                            <label class="checkbox-item">
                                <input type="checkbox" name="problem[]" value="Toilet Problem">
                                <span>Toilet Problem</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="problem[]" value="No Internet">
                                <span>No Internet</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="problem[]" value="No Water">
                                <span>No Water</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="problem[]" value="No Electricity">
                                <span>No Electricity</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="problem[]" value="No Signal">
                                <span>No Signal</span>
                            </label>
                            <label class="checkbox-item" id="others-checkbox">
                                <input type="checkbox" name="problem[]" value="Others">
                                <span>Others: <span class="specify-text">(Please Specify)</span></span>
                            </label>
                        </div>
                    </div>

                    <div class="form-group-modern" id="other-description-field" style="display: none;">
                        <textarea name="other_description" placeholder="Please specify other problems..." rows="2"></textarea>
                    </div>

                    <div class="form-group-modern">
                        <label class="form-label">Description</label>
                        <textarea name="description" placeholder="Respondent's answer..." rows="6" required></textarea>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn-submit-modern">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const othersCheckbox = document.querySelector('input[value="Others"]');
            const otherField = document.getElementById('other-description-field');

            function toggleOtherField() {
                if (othersCheckbox && othersCheckbox.checked) {
                    otherField.style.display = 'block';
                } else {
                    otherField.style.display = 'none';
                    const textarea = otherField.querySelector('textarea');
                    if (textarea) textarea.value = '';
                }
            }

            if (othersCheckbox) {
                othersCheckbox.addEventListener('change', toggleOtherField);
                toggleOtherField();
            }
        });
    </script>
</body>
</html>
